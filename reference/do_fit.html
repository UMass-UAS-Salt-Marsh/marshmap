<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit models — do_fit • marshmap</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit models — do_fit"><meta name="description" content="Fit models"><meta property="og:description" content="Fit models"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">marshmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UMass-UAS-Salt-Marsh/marshmap/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit models</h1>
      <small class="dont-index">Source: <a href="https://github.com/UMass-UAS-Salt-Marsh/marshmap/blob/main/R/do_fit.R" class="external-link"><code>R/do_fit.R</code></a></small>
      <div class="d-none name"><code>do_fit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit models</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">do_fit</span><span class="op">(</span></span>
<span>  <span class="va">fitid</span>,</span>
<span>  <span class="va">sites</span>,</span>
<span>  <span class="va">name</span>,</span>
<span>  <span class="va">method</span>,</span>
<span>  <span class="va">fitargs</span>,</span>
<span>  <span class="va">vars</span>,</span>
<span>  <span class="va">exclude_vars</span>,</span>
<span>  <span class="va">exclude_classes</span>,</span>
<span>  <span class="va">include_classes</span>,</span>
<span>  <span class="va">exclude_years</span>,</span>
<span>  <span class="va">min_class</span>,</span>
<span>  <span class="va">reclass</span>,</span>
<span>  <span class="va">max_samples</span>,</span>
<span>  <span class="va">years</span>,</span>
<span>  <span class="va">minscore</span>,</span>
<span>  <span class="va">maxmissing</span>,</span>
<span>  <span class="va">max_miss_train</span>,</span>
<span>  <span class="va">top_importance</span>,</span>
<span>  <span class="va">holdout</span>,</span>
<span>  <span class="va">bypoly</span>,</span>
<span>  <span class="va">byyear</span>,</span>
<span>  <span class="va">blocks</span>,</span>
<span>  <span class="va">auc</span>,</span>
<span>  <span class="va">hyper</span>,</span>
<span>  <span class="va">notune</span>,</span>
<span>  rep <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fitid">fitid<a class="anchor" aria-label="anchor" href="#arg-fitid"></a></dt>
<dd><p>Fit id in the fits database</p></dd>


<dt id="arg-sites">sites<a class="anchor" aria-label="anchor" href="#arg-sites"></a></dt>
<dd><p>Data frame with <code>site</code> (3 letter code), <code>site_name</code> (long name), and
<code>datafile</code> (resolved path and filename of datafile). Sites, paths, and filenames
are vetted by fit - there's no checking here.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>Optional model name</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>One of <code>rf</code> for Random Forest, <code>boost</code> for AdaBoost. Default = <code>rf</code>.</p></dd>


<dt id="arg-fitargs">fitargs<a class="anchor" aria-label="anchor" href="#arg-fitargs"></a></dt>
<dd><p>A named list of additional arguments to pass to the model (<code>ranger</code> or <code>boost</code>)</p></dd>


<dt id="arg-vars">vars<a class="anchor" aria-label="anchor" href="#arg-vars"></a></dt>
<dd><p>Vector of variables to restrict analysis to. Default = <code>{*}</code>,
all variables. <code>vars</code> is processed by <code>find_orthos</code>, and may include file names,
portable names, search names and regular expressions of file and portable names.</p></dd>


<dt id="arg-exclude-vars">exclude_vars<a class="anchor" aria-label="anchor" href="#arg-exclude-vars"></a></dt>
<dd><p>An optional vector of variables to exclude. As with <code>vars</code>, variables
are processed by <code>find_orthos</code></p></dd>


<dt id="arg-exclude-classes">exclude_classes<a class="anchor" aria-label="anchor" href="#arg-exclude-classes"></a></dt>
<dd><p>Numeric vector of subclasses to exclude. This overrides <code>fit_exclude</code>
that may be included in <code>sites.txt</code>.</p></dd>


<dt id="arg-include-classes">include_classes<a class="anchor" aria-label="anchor" href="#arg-include-classes"></a></dt>
<dd><p>Numeric vector of subclasses to include - all other classes are dropped.
<code>include_classes</code> overrides <code>fit_exclude</code> (in <code>sites.txt</code>) and <code>exclude_classes</code>.</p></dd>


<dt id="arg-exclude-years">exclude_years<a class="anchor" aria-label="anchor" href="#arg-exclude-years"></a></dt>
<dd><p>A vector of one or more years of ground truth data to exclude (requires a
year column in source data)</p></dd>


<dt id="arg-min-class">min_class<a class="anchor" aria-label="anchor" href="#arg-min-class"></a></dt>
<dd><p>Minimum number of training samples to allow in a class. All classes with
fewer samples in training set as well as all classes with zero cases in the
validation set will be dropped from the model. Use <code>min_class = NULL</code> to prevent
dropping any classes.</p></dd>


<dt id="arg-reclass">reclass<a class="anchor" aria-label="anchor" href="#arg-reclass"></a></dt>
<dd><p>Matrix or vector of paired classes to reclassify. Pass either a two column
matrix, such that values in the first column are reclassifed to the second column, or a
vector with pairs, <code>reclass = c(13, 2, 3, 4)</code>, which would reclassify all 13s to 2 and 3s to 4,
lumping each pair of classes. Reclassifying is not iterative, thus you could swap
1s and 2s with <code>reclass = c(1, 2, 2, 1)</code>, not that you'd want to.</p></dd>


<dt id="arg-max-samples">max_samples<a class="anchor" aria-label="anchor" href="#arg-max-samples"></a></dt>
<dd><p>Maximum number of samples to use - subsample if necessary</p></dd>


<dt id="arg-years">years<a class="anchor" aria-label="anchor" href="#arg-years"></a></dt>
<dd><p>Vector of years to restrict variables to</p></dd>


<dt id="arg-minscore">minscore<a class="anchor" aria-label="anchor" href="#arg-minscore"></a></dt>
<dd><p>Minimum score for orthos. Files with a minimum score of less than
this are excluded from results. Default is 0, but rejected orthos are always
excluded.</p></dd>


<dt id="arg-maxmissing">maxmissing<a class="anchor" aria-label="anchor" href="#arg-maxmissing"></a></dt>
<dd><p>Maximum percent missing in orthos. Files with percent missing greater
than this are excluded.</p></dd>


<dt id="arg-max-miss-train">max_miss_train<a class="anchor" aria-label="anchor" href="#arg-max-miss-train"></a></dt>
<dd><p>Maximum proportion of missing training points allowed before a
variable is dropped</p></dd>


<dt id="arg-top-importance">top_importance<a class="anchor" aria-label="anchor" href="#arg-top-importance"></a></dt>
<dd><p>Number of variables to keep for variable importance</p></dd>


<dt id="arg-holdout">holdout<a class="anchor" aria-label="anchor" href="#arg-holdout"></a></dt>
<dd><p>Proportion of points to hold out. For Random Forest, this specifies
the size of the single validation set, while for boosting, it is the size of each
of the testing and validation sets.</p></dd>


<dt id="arg-bypoly">bypoly<a class="anchor" aria-label="anchor" href="#arg-bypoly"></a></dt>
<dd><p>The name of a <code>bypoly</code> cross-validation sequence in the sampled data.
<code>gather</code> creates <code>bypoly01</code> through <code>bypoly05</code>, with sequences of 1:10 for each
subclass. Poly groups 1 and 6 will be used as holdouts. To specify different groups,
use <code>blocks = list(block = 'bypoly01', classes = c(2, 7)</code>, for instance.</p></dd>


<dt id="arg-byyear">byyear<a class="anchor" aria-label="anchor" href="#arg-byyear"></a></dt>
<dd><p>One or more years to treat as holdout data. If supplied, this superceeds bypoly.</p></dd>


<dt id="arg-blocks">blocks<a class="anchor" aria-label="anchor" href="#arg-blocks"></a></dt>
<dd><p>An alternative to holding out random points. Specify a named list
with <code>block = &lt;name of block column&gt;, classes = &lt;vector of block classes to hold out&gt;</code>.
Set this up by creating a shapefile corresponding to ground truth data with a variable
<code>block</code> that contains integer block classes, and placing it in the <code>blocks/</code> directory
for the site. <code>gather</code> and <code>sample</code> will collect and process block data for you to
use here.</p></dd>


<dt id="arg-auc">auc<a class="anchor" aria-label="anchor" href="#arg-auc"></a></dt>
<dd><p>If TRUE, calculate class probabilities so we can calculate AUC</p></dd>


<dt id="arg-hyper">hyper<a class="anchor" aria-label="anchor" href="#arg-hyper"></a></dt>
<dd><p>Hyperparameters <em><strong>To be defined</strong></em></p></dd>


<dt id="arg-notune">notune<a class="anchor" aria-label="anchor" href="#arg-notune"></a></dt>
<dd><p>If TRUE, don't do hyperparameter tuning. This can cost you a few percent
in CCR, but will speed the run up six-fold from the default.</p></dd>


<dt id="arg-rep">rep<a class="anchor" aria-label="anchor" href="#arg-rep"></a></dt>
<dd><p>Throwaway argument to make <code>slurmcollie</code> happy</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bradley Compton.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

